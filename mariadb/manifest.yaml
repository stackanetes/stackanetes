---
package:
  name: quentinm/mariadb
  author: Quentin Machu
  version: 0.1.0
  description: mariadb
  license: Apache 2.0

variables:
  namespace: default
  node_label: openstack-control-plane
  image: quay.io/stackanetes/stackanetes-mariadb:barcelona

  # Network.
  ip_address: "{% raw %}{{ .IP }}{% endraw %}"
  port: 3306
  wsrep_port: 4567
  ist_port: 4568
  sst_port: 4444

  # Initial root password.
  password: password

  # Cluster configuration.
  # TODO: Replace node_name. {{ .HOSTNAME }} can't get replaced properly
  # by the kubernetes-entrypoint on rkt because the ev variable doesn't
  # exist. POD_NAME however does exist but it would be better to just get
  # it from the container instead.
  node_name: master
  cluster_name: mariadb

resources:
  # Config maps.
  - file: configmaps/my.cnf.yaml
    name: mariadb-mycnf
    type: configmap

  - file: configmaps/start.sh.yaml
    name: mariadb-startsh
    type: configmap

  # Daemons.
  - file: deployment.yaml
    name: mariadb
    type: deployment

  # Services.
  - file: service.yaml
    name: mariadb
    type: service

deploy:
  - name: $self
